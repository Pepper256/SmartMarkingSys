# SmartMarkingSys SQLite 数据库构造说明

## 1. 概述

本项目采用 SQLite 作为本地持久化存储方案。SQLite 数据库以单一 `.db` 文件形式存在，可随项目运行自动创建与维护，无需额外部署数据库服务。

数据库用于保存项目运行过程中产生的结构化数据（如试卷、答案、报告等），以满足“程序退出后再次运行仍可读取历史数据”的持久化要求。

---

## 2. 数据库文件位置与生成规则

### 2.1 默认路径

数据库文件默认路径为：

- `./database/smartmark.db`

### 2.2 自动创建

当程序首次运行并触发数据库连接/初始化/写入时：

- 若 `./database/` 目录不存在，将自动创建该目录；
- 若 `./database/smartmark.db` 不存在，将自动创建该文件；
- 随后依据建表脚本初始化所需表结构。

> 说明：SQLite 数据库文件会在实际发生连接/初始化/写入操作时创建；仅编译项目不会生成 `.db`。

---

## 3. 表结构初始化机制

### 3.1 建表脚本来源

本项目的建表脚本位于：

- `src/main/resources/database/schema.sql`

该脚本定义数据库的表结构、字段与必要约束。数据库初始化时应执行该脚本，以保证运行环境一致。

### 3.2 初始化时机与幂等性要求

数据库初始化应在应用启动后、任何 DAO 读写操作之前完成，并满足以下要求：

- **幂等性**：重复执行初始化逻辑不得破坏已有数据；
- **一致性**：数据库结构应与 `schema.sql` 保持一致；
- **可扩展性**：后续版本如引入新表/新字段，应提供兼容的结构升级策略（增量变更或版本迁移）。

---

## 4. 数据持久化与验收

### 4.1 持久化行为

数据写入 SQLite 后应持久保存在 `./database/smartmark.db` 中，程序退出不会丢失数据。再次启动程序时，DAO 层应能够从同一数据库文件读取历史数据。

### 4.2 验收步骤

1. 运行程序，执行一次“上传试卷 + 上传答案”（或任何触发 DAO 写入的操作）。
2. 正常退出程序。
3. 再次启动程序并执行读取流程。
4. 确认：
   - `./database/smartmark.db` 文件仍存在；
   - 数据可被正常读取；
   - 数据内容与预期一致。

---

